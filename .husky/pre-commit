#!/bin/sh

# Get list of staged Python files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.py$' || true)

if [ -z "$STAGED_FILES" ]; then
    echo "No Python files to check"
    exit 0
fi

echo "🔍 Running pre-commit checks on Python files..."

# Activate virtual environment
. .venv/bin/activate

# 1. Format check
echo "1/4 ✨ Checking code formatting..."
ruff format --check $STAGED_FILES

# 2. Linting
echo "2/4 🔎 Running linter..."
ruff check $STAGED_FILES

# 3. Type checking
echo "3/4 🔬 Running type checker..."
mypy $STAGED_FILES --no-error-summary

echo "✅ All pre-commit checks passed!"
